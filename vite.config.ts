// vite.config.ts
import { defineConfig } from 'vite';

// https://vitejs.dev/config/
export default defineConfig({
  // Настройки для сервера разработки (команда 'npm run dev')
  server: {
    port: 5173, // Вы можете изменить порт, если он занят
    open: true,   // Автоматически открывать приложение в браузере при запуске
  },

  // Настройки для сборки продакшен-версии (команда 'npm run build')
  build: {
    // Опция для генерации source maps. Помогает при отладке в продакшене,
    // но для максимальной производительности можно установить в 'false' или 'hidden'.
    sourcemap: true,

    // Vite будет пытаться "встряхнуть" неиспользуемый код, чтобы уменьшить размер бандла.
    // Эта опция включена по умолчанию.

    // Оптимизация разделения кода (Code Splitting).
    // Vite автоматически разделит код на более мелкие "куски" (chunks),
    // чтобы браузер мог загружать их параллельно и только по мере необходимости.
    rollupOptions: {
      output: {
        manualChunks(id) {
          // Эта простая логика отправляет все, что находится в node_modules,
          // в один большой файл 'vendor.js'. Это улучшает кэширование,
          // так как код библиотек меняется редко.
          if (id.includes('node_modules')) {
            return 'vendor';
          }
        }
      }
    }
  }
});
